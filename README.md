# Regression with a Mohs Hardness Dataset

Учебный проект по курсу «Light AutoML», выполненный на соревновании  
[Kaggle: Regression with a Mohs Hardness Dataset (Playground Series S3E25)][https://www.kaggle.com/competitions/playground-series-s3e25/overview].


## Выполнил
Карсаков Григорий Вячеславович, 2 курс, ATH

---

## Структура репозитория

- `playground-series-s3e25/`
    - `train.csv` - обучающая выборка (признаки минералов + таргет `Hardness`).
    - `test.csv` - тестовая выборка без таргета.
    - `sample_submission.csv` - пример формата сабмишена.

- `submissions`
    - `automl1.csv` - сабмишен для первого lama бейзлайна.
    - `automl2.csv` - сабмишен для второго lama бейзлайна.
    - `optuna.csv` - сабмишен для собсвенной модели.
- `solution.ipynb` - код решения.
- `requirements.txt` - список зависимостей проекта.
- `README.md` - описание проекта (текущий файл).

---

## Подход

В проекте реализовано два независимых подхода:

1. **Бейзлайн на LightAutoML**
   - Используются пресеты `TabularAutoML` и `TabularUtilizedAutoML`.
   - Автоматическая типизация признаков, базовый препроцессинг, ансамбль моделей (линейные модели, градиентный бустинг и др.).
   - Несколько конфигураций таймаута и набора алгоритмов, выбор лучшей по CV‑метрике.

2. **Кастомный пайплайн с Optuna**
   - Явный препроцессинг: обработка пропусков, масштабирование, генерация и отбор признаков.
   - Модели: градиентный бустинг (например, XGBoost/LightGBM/CatBoost) и другие регрессионные алгоритмы, обернутые в `sklearn`‑совместимый пайплайн.
   - Настройка гиперпараметров с помощью Optuna с использованием блочной k‑fold кросс‑валидации, чтобы избежать утечки данных.
   - Лучшая найденная конфигурация используется для обучения на всей train‑выборке и получения предсказаний для test‑набора.

---

## Метрика качества

Оценка в соревновании проводится по **MedAE**.

---

## Результаты

- LAMA бейзлайны (`TabularAutoML`, `TabularUtilizedAutoML`) дают публичный скор около **0.60–0.61 MedAE**, приватный - около **0.61–0.63**.
- Кастомный пайплайн с Optuna достигает **~0.51 MedAE** на публичном и **~0.50 MedAE** на приватном лидерборде, заметно превосходя оба AutoML‑подхода и приближаясь к лучшим решениям соревнования.

Таким образом, цель проекта по улучшению результата относительно LightAutoML‑бейзлайна достигнута.

